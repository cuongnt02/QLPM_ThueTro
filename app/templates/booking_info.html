{% extends "base.html" %}
{% import "bootstrap_wtf.html" as wtf %}

{% block css %}
    {{ super() }}
{% endblock %}

{% block title %}
    {{ super() }}
{% endblock %}
{% block head %} {{ super() }}
{% endblock %}

{% block header %}
    {% block nav %}
        {{ super() }}
    {% endblock %}
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col s12">
            <h1>Thông tin đặt cọc</h1>
        </div>
    </div>
    <div class="row">
        <div class="row">
            <p class="col-6"><strong>Phòng:</strong></p>
            <p class="col-6">{{booking.room.room_name}}</p>
        </div>
        <div class="row">
            <p class="col-6"><strong>Giá cọc:</strong></p>
            <p class="col-6">{{booking.total_price}}</p>
        </div>
        <div class="row">
            <p class="col-6"><strong>Ngày đặt:</strong></p>
            <p class="col-6">{{booking.start_date}}</p>
        </div>
        <div class="row">
            <p class="col-6"><strong>Ngày hết hạn:</strong></p>
            <p class="col-6">{{booking.end_date}}</p>
        </div>
    </div>
        

        <!-- Thêm nút thanh toán PayPal -->
        <h2>Thanh toán</h2>
    <div id="paypal-button-container"></div>
    <button class="btn btn-primary" onclick="momoPayment('{{url_for('momo_payment')}}?paymentName=Booking%20for%20room%20{{booking.room.room_name}}&totalPrice={{booking.total_price}}');">Thanh toán với MOMO</button>
{% endblock %}
{% block js%}
<script src="https://www.paypal.com/sdk/js?client-id=ARjB0Vl_utFQqmJzoM7ABib94XnH8q63urVLtrlvEgQkT_c_cZtYwHhSh7dvaQflMQ0NgeyzTqixSMDx&currency=USD"></script>
<script>
 paypal.Buttons({
    createOrder: function(data, actions) {
        return actions.order.create({
            purchase_units: [{
                amount: {
                    value: '{{ booking.total_price }}'
                }
            }]
        });
    },
    onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
            window.location.href = "{{ url_for('payment_execute', room_id=booking.room.id, _external=True) }}?orderID=" + data.orderID + "&payerID=" + details.payer.payer_id;
        });
    },
    onCancel: function(data) {
        window.location.href = "{{ url_for('payment_cancel', room_id=booking.room.id, _external=True) }}";
    }
}).render('#paypal-button-container');

</script>
<script src="{{ url_for('static', filename='js/momo.js')}}"></script>
{% endblock %}
